}
summarize_e5 <- function(e5){
e5_image <- e5 %>% group_by(target) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
n_eight = sum(response == "8"),
meaneight = n_eight/n_trials,
cilo8 = binom.confint(n_eight,length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi8 = binom.confint(n_eight,length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]],
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e5_subject <- e5 %>% group_by(subject) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e5_image$target <- ordered(e5_image$target, levels=e5_image$target[order(e5_image$meancx)])
e5_subject$subject <- ordered(e5_subject$subject, levels=e5_subject$subject[order(e5_subject$meancx)])
return(list("image"=e5_image,
"subject"=e5_subject))
}
summarize_6 <- function(e6){
e6_image <- e6 %>% group_by(target) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e6_subject <- e6 %>% group_by(subject) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e6_image$target <- ordered(e6_image$target, levels=e6_image$target[order(e6_image$meancx)])
e6_subject$subject <- ordered(e6_subject$subject, levels=e6_subject$subject[order(e6_subject$meancx)])
return(list("image"=e6_image,
"subject"=e6_subject))
}
summarize_7 <- function(e7){
e7_image <- e7 %>% group_by(imageName) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
target = target[1],
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e7_subject <- e7 %>% group_by(subject) %>%
summarize(n_trials = length(correct),
n_correct = sum(correct),
meancx = n_correct/n_trials,
cilo = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[5]],
cihi = binom.confint(sum(correct),length(correct),
conf.level=0.99,method="exact",
alternative="greater")[[6]])
e7_image$imageName <- ordered(e7_image$imageName, levels=e7_image$imageName[order(e7_image$meancx)])
e7_subject$subject <- ordered(e7_subject$subject, levels=e7_subject$subject[order(e7_subject$meancx)])
return(list("image"=e7_image,
"subject"=e7_subject))
}
# and some convenience functions to make our basic plots
plot_image <- function(ex_image, ex_num){
if (ex_num %in% c("3a", "3b")){
y_height = 1/48
} else if (ex_num == "4"){
y_height = 1/8
} else if (ex_num == "5"){
y_height = 1/9
} else {
y_height = 0.5
}
if (ex_num == "7"){
ex_image$image <- paste(ex_image$image, ex_image$target, sep=" - ")
ex_image$image <- ordered(ex_image$image, levels=ex_image$image[order(ex_image$meancx)])
}
g.image <- ggplot(ex_image, aes(x=image, y=meancx, ymin=cilo, ymax=cihi))+
geom_pointrange()+
geom_hline(yintercept = y_height, color="red")+
labs(title=paste("Experiment", ex_num, "- Mean Accuracy of Images"),
y="Mean accuracy across subjects")+
theme(axis.text = element_text(size=unit(14,"pt")),
axis.title = element_text(size=unit(20,"pt")),
axis.text.x = element_text(angle=45, hjust=1))
return(g.image)
}
plot_subject <- function(ex_subject, ex_num){
if (ex_num %in% c("3a", "3b")){
y_height = 1/48
} else if (ex_num == "4"){
y_height=1/8
} else if (ex_num == "5"){
y_height=1/9
} else {
y_height = 0.5
}
g.subject <- ggplot(ex_subject, aes(x=subject, y=meancx, ymin=cilo, ymax=cihi))+
geom_pointrange()+
geom_hline(yintercept = y_height, color="red")+
labs(title=paste("Experiment", ex_num, "- Mean Accuracy of Subject"),
y="Mean accuracy across images")+
theme(axis.text.x = element_blank())
return(g.subject)
}
# and to compute subject and image accuracies using confidence intervals instead of means
adjusted_accuracy <- function(ex_image, ex_subject, level=0.5){
ex_img_accuracy <- nrow(ex_image[ex_image$cilo>level,])/nrow(ex_image)
ex_subject_accuracy <- nrow(ex_subject[ex_subject$cilo>level,])/nrow(ex_subject)
# round for inclusion in the text
ex_img_accuracy <- round(ex_img_accuracy, 3)*100
ex_subject_accuracy <- round(ex_subject_accuracy,3)*100
return(list(image = ex_img_accuracy,
subject = ex_subject_accuracy))
}
# summarize the data and expand list to new
sum_1 <- summarize_data(expt_1)
e1_image <- sum_1$image
e1_subject <- sum_1$subject
g.e1_image <- plot_image(e1_image, "1")
g.e1_image
g.e1_subject <- plot_subject(e1_subject, "1")
g.e1_subject
e1_accs <- adjusted_accuracy(e1_image, e1_subject)
e2_summary <- summarize_data(expt_2)
e2_image <- e2_summary$image
e2_subject <- e2_summary$subject
g.e2_img <- plot_image(e2_image, "2")
g.e2_img
g.e2_subject <- plot_subject(e2_subject, "2")
g.e2_subject
e2_accs <- adjusted_accuracy(e2_image, e2_subject)
total_acc <- nrow(expt_2[expt_2$`correct?`== TRUE,])/nrow(expt_2)
total_acc <- round(total_acc, 3) * 100
e12_images <- left_join(e1_image, e2_image, by="image")
e12_images$image <- ordered(e12_images$image, levels=e12_images$image[order(e12_images$meancx.x)])
ggplot(e12_images, aes(x=image, ymin=cilo.x, ymax=cihi.x, y=meancx.x))+
geom_pointrange()+
geom_pointrange(aes(ymin=cilo.y, ymax=cihi.y, y=meancx.y),color="red")+
geom_hline(yintercept = 0.5, color="red")+
labs(title="Experiment 1 vs Experiment 2 - Mean Accuracy of Images",
y="Mean accuracy across subjects")+
theme(axis.text.x = element_text(angle=45, hjust=1))
e3a_summary <- summarize_data(expt_3a)
e3a_image <- e3a_summary$image
e3a_subject <- e3a_summary$subject
g.e3a_image <- plot_image(e3a_image, "3a")
g.e3a_image
g.e3a_sub <- plot_subject(e3a_subject, "3a")
g.e3a_sub
e3a_acc <- adjusted_accuracy(e3a_image, e3a_subject, level=1/48)
e4_sum <- summarize_e4(expt_4)
e4_image <- e4_sum$image
e4_subject <- e4_sum$subject
e4_trial <- e4_sum$trial
e4_acc <- adjusted_accuracy(e4_image, e4_subject, level=1/8)
ggplot(e4_trial, aes(x=trialNum, y=meancx))+
geom_pointrange(aes(ymin=cilo, ymax=cihi))+
geom_smooth(method="lm")
e4_lm <- lm(meancx~trialNum, data=e4_trial)
summary(e4_lm)
g.e4_image <- plot_image(e4_image, "4")
g.e4_image
g.e4_subject <- plot_subject(e4_subject, "4")
g.e4_subject
e5_sum <- summarize_e5(expt_5)
e5_image <- e5_sum$image
e5_subject <- e5_sum$subject
e5_image$image <- e5_image$target
e5_accs <- adjusted_accuracy(e5_image, e5_subject, level=1/9)
g.e5_image <- plot_image(e5_image, "5")
g.e5_image
expt_5$response <- as.factor(expt_5$response)
expt_5$target <- as.factor(expt_5$target)
cm5 <- caret::confusionMatrix(expt_5$response, expt_5$target)
cm5 <- reshape2::melt(cm5$table)
ggplot(cm5, aes(x=as.factor(Reference), y=as.factor(Prediction), fill=value))+
geom_tile()
ggplot(e5_image, aes(x=target, ymin=cilo, ymax=cihi, y=meancx))+
geom_pointrange()+
geom_pointrange(aes(ymin=cilo8, ymax=cihi8, y=meaneight), color="red")+
geom_hline(yintercept = 1/9, color="red")+
labs(title="Experiment 5 - black = mean correct responses, red = mean 8 responses")+
theme(axis.text.x = element_text(angle=45, hjust=1))
g.e5_subject <- plot_subject(e5_subject, "5")
g.e5_subject
e6_sum <- summarize_6(expt_6)
e6_image <- e6_sum$image
e6_subject <- e6_sum$subject
e6_image$image <- e6_image$target
g.e6_image <- plot_image(e6_image, "6")
g.e6_image
g.e6_subject <- plot_subject(e6_subject, "6")
g.e6_subject
e7_sum <- summarize_7(expt_7)
e7_image <- e7_sum$image
e7_subject <- e7_sum$subject
e7_image$image <- e7_image$imageName
e7_acc <- adjusted_accuracy(e7_image, e7_subject, 0.5)
g.e7_image <- plot_image(e7_image, "7")
g.e7_image
g.e7_subject <- plot_subject(e7_subject, "7")
g.e7_subject
e7_acc <- sum(expt_7$correct)/nrow(expt_7)
e1_image$n_trials
e2_image$n_trials
all_images <- rbind("expt_1"=expt_1,
"expt_2"=expt_2,
"expt_3a"=expt_3a,
"expt_3b"=expt_3b,
"expt_4"=expt_4,
"expt_5"=expt_5,
"expt_6"=expt_6,
"expt_7"=expt_7,
.id="expt")
head(expt_1)
head(expt_2)
head(expt_3a)
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image,
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
e3b_summary <- summarize_data(expt_3b)
e3b_image <- e3b_summary$image
e3b_subject <- e3b_summary$subject
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image,
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
head(e1_image)
head(e2_image)
head(e3_image)
head(e3a_image)
head(e3b_image)
head(e4_image)
head(e5_image)
head(e6_image)
e4_image$meanrt <- NULL
e6_image$meanrt <- NULL
e7_image$meanrt <- NULL
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image[,-c("n_eight","meaneight","cilo8","cihi8")],
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image[,-c(5,6,7,8)],
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
head(e5_image[,-c(5,6,7,8)])
e5_image$meanrt <- NULL
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image[,-c(5,6,7,8)],
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
head(e5_image[,-c(5,6,7,8)])
e4_image$meanrt <- NA
e5_image$meanrt <- NA
e6_image$meanrt <- NA
e7_image$meanrt <- NA
all_images <- rbind("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_image[,-c(5,6,7,8)],
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
e5_sub <- e5_image[,-c(5,6,7,8)]
head(e1_image)
all_images <- bind_rows("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_sub,
"expt_6"=e6_image,
"expt_7"=expt_7,
.id="expt")
head(all_images)
all_images <- bind_rows("expt_1"=e1_image,
"expt_2"=e2_image,
"expt_3a"=e3a_image,
"expt_3b"=e3b_image,
"expt_4"=e4_image,
"expt_5"=e5_sub,
"expt_6"=e6_image,
"expt_7"=e7_image,
.id="expt")
head(all_images)
bind_rows(e1_accs, e2_accs)
z <_ bind_rows(e1_accs, e2_accs)
z <- bind_rows(e1_accs, e2_accs)
z
z <- bind_rows(e1_accs, e2_accs, .id="expt")
z
e3b_accs <- adjusted_accuracy(e3b_image, e3b_subject,level=1/48)
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
e3a_accs <- adjusted_accuracy(e3a_image, e3a_subject, level=1/48)
e3b_accs <- adjusted_accuracy(e3b_image, e3b_subject,level=1/48)
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
e6_accs <- adjusted_accuracy(e6_image, e6_subject, level=0.5)
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
e4_accs <- e4_acc
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
e7_accs <- e7_acc
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs)
e7_accs
e7_accs <- adjusted_accuracy(e7_image, e7_subject)
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
all_images
all_images$reported_img <-     c(94, 71, 79, 81, 100, 73, 100, 78)
all_images$reported_subject <- c(98, 91, 88, 90, 81,  89, 87,  83)
all_im_melt <- reshape2::melt(all_images, measure.vars=c("image", "subject", "reported_img", "reported_subject"))
head(all_im_melt)
all_im_melt$type <- "image"
all_im_melt[all_im_melt$variable %in% c("subject", "reported_subject"),]$type <- "subjct"
all_im_melt$which <- "adjusted"
all_im_melt[all_im_melt$variable %in% c("reported_subject", "reported_img"),]$which <- "reported"
ggplot(all_im_melt, aes(x=interaction(type, which), y=value,
fill=interaction(type, which)))+
geom_col()
ggplot(all_im_melt, aes(x=interaction(expt,type, which), y=value,
fill=interaction(type, which)))+
geom_col()
ggplot(all_im_melt, aes(x=interaction(expt,type, which), y=value,
fill=interaction(type, which)))+
geom_col()
ggplot(all_im_melt, aes(x=interaction(expt, which,type), y=value,
fill=interaction(type, which)))+
geom_col()
ggplot(all_im_melt, aes(x=interaction(expt, which,type), y=value,
fill=interaction(type, which)))+
geom_col()
ggplot(all_im_melt, aes(x=interaction(expt, which,type), y=value,
fill=interaction(type, which)))+
geom_col()+
theme(axis.text.x=element_text(angle=45,hjust=1))
ggplot(all_im_melt, aes(x=interaction(which,type,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
theme(axis.text.x=element_text(angle=45,hjust=1))
ggplot(all_im_melt, aes(x=interaction(type,which,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
theme(axis.text.x=element_text(angle=45,hjust=1))
all_im_melt$type <- "image"
all_im_melt[all_im_melt$variable %in% c("subject", "reported_subject"),]$type <- "subject"
all_im_melt$which <- "adjusted"
all_im_melt[all_im_melt$variable %in% c("reported_subject", "reported_img"),]$which <- "reported"
ggplot(all_im_melt, aes(x=interaction(type,which,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
scale_fill_brewer(palette="Paired")+
theme(axis.text.x=element_text(angle=45,hjust=1))
all_im_melt$expt <- ordered(all_im_melt$expt, levels=experiment_names)
all_im_melt$type <- ordered(all_im_melt$type, levels=c("subject", "image"))
all_im_melt$type <- ordered(all_im_melt$which, levels=c("reported", "adjusted"))
ggplot(all_im_melt, aes(x=interaction(type,which,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
scale_fill_brewer(palette="Paired")+
theme(axis.text.x=element_text(angle=45,hjust=1))
all_images <- bind_rows("expt_1"=e1_accs,
"expt_2"=e2_accs,
"expt_3a"=e3a_accs,
"expt_3b"=e3b_accs,
"expt_4"=e4_accs,
"expt_5"=e5_accs,
"expt_6"=e6_accs,
"expt_7"=e7_accs,
.id="expt")
all_images$reported_img <-     c(94, 71, 79, 81, 100, 73, 100, 78)
all_images$reported_subject <- c(98, 91, 88, 90, 81,  89, 87,  83)
all_im_melt <- reshape2::melt(all_images, measure.vars=c("image", "subject", "reported_img", "reported_subject"))
all_im_melt$type <- "image"
all_im_melt[all_im_melt$variable %in% c("subject", "reported_subject"),]$type <- "subject"
all_im_melt$which <- "adjusted"
all_im_melt[all_im_melt$variable %in% c("reported_subject", "reported_img"),]$which <- "reported"
all_im_melt$expt <- ordered(all_im_melt$expt, levels=experiment_names)
all_im_melt$type <- ordered(all_im_melt$type, levels=c("subject", "image"))
all_im_melt$which <- ordered(all_im_melt$which, levels=c("reported", "adjusted"))
ggplot(all_im_melt, aes(x=interaction(type,which,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
scale_fill_brewer(palette="Paired")+
theme(axis.text.x=element_text(angle=45,hjust=1))
all_im_melt$type <- ordered(all_im_melt$type, levels=c("image", "subject"))
ggplot(all_im_melt, aes(x=interaction(type,which,expt), y=value,
fill=interaction(type, which)))+
geom_col()+
scale_fill_brewer(palette="Paired")+
theme(axis.text.x=element_text(angle=45,hjust=1))
all_im_melt$which_type <- paste(all_im_melt$type, all_im_melt$which)
unique(all_im_melt$which_type)
all_im_melt$which_type <- ordered(all_im_melt$which_type, levels=c("image reported", "subject reported", "image adjusted", "subject adjusted"))
ggplot(all_im_melt, aes(x=expt, y=value,
fill=which_type))+
geom_col(position="dodge")+
scale_fill_brewer(palette="Paired")+
theme(axis.text.x=element_text(angle=45,hjust=1))
ggplot(all_im_melt, aes(x=expt,color=which_type))+
geom_point(aes(y=value), position="dodge")
ggplot(all_im_melt, aes(x=interaction(expt, type),color=which_type))+
geom_point(aes(y=value), position="dodge")
